define(function(require,module,exports){require("zepto"),template=require("artTemplate"),require("fastclick"),FastClick.attach(document.body),template.helper("labelPeriod",function(isDay,num,index){if("Y"==isDay)var unit="天";else var unit="个月";return 0==index?num+unit:"<span class='fc-3'>"+num+"</span>"+unit}),template.helper("fixToSecond",function(value){return(1*value).toFixed(2)}),template.helper("BarProgress",function(hasSend,total){return hasSend/total*100}),template.helper("LabelStatus",function(status){return 0==status?"已售罄":1==status?"可购买":4==status?"待开售":void 0}),template.helper("LabelClass",function(status){return 0==status?"not_start":1==status?"":4==status?"not_start":void 0}),$(function(){var App=function(){function orient(){return 0==window.orientation||180==window.orientation?($("body").attr("class","portrait"),orientation="portrait",!1):90==window.orientation||-90==window.orientation?($("body").attr("class","landscape"),orientation="landscape",!1):void 0}this.url={wapUrl:$("#wapurl").val(),bannerList:"/api/getWapBanner.html",labelList:"/api/getBorrowList.html"},this.tpl={bannerTpl:template.compile($("#topBannerTpl").html()),labelListTpl:template.compile($("#borrow-list-template").html())},this.isLogin=function(){return $(".has_login_box").length>0?!0:!1}(),this.init(),this.slider(),this.loadList(),$(window).bind("orientationchange",function(e){orient()})};App.prototype={init:function(){$(window).width(),window.innerWidth,document.body.innerWidth;$("body").on("click",".tap-link",function(){var $elem=$(this),href=$elem.attr("data-href");""!=href&&(window.location.href=href)})},slider:function(){var self=this;require("swiper");var url=self.url.wapUrl+self.url.bannerList;$.ajax({url:url,dataType:"get",dataType:"jsonp",success:function(data){if(data.result)if(1==data.code){self.isLogin||data.imageResourcesList.forEach(function(item,index){1==item.isLoginSee&&data.imageResourcesList.splice(index,1)});var bannerhtml=self.tpl.bannerTpl(data);$("#indexSlider .swiper-wrapper").html(bannerhtml);var swiperCfg={loop:!0,autoHeight:!0,noSwiping:!0,autoplay:3e3,speed:400,autoplayDisableOnInteraction:!1};1==data.imageResourcesList.length&&(swiperCfg.loop=!1);new Swiper("#indexSlider",swiperCfg)}else 0==data.code}})},loadList:function(){var self=this,url=self.url.wapUrl+self.url.labelList,param={currentPage:1,pernum:1e4};$.ajax({url:url,type:"get",dataType:"jsonp",data:param,success:function(data){if(data.result){if(1==data.code){var html=self.tpl.labelListTpl(data);$("#index_label_ul").html(html),$("#loading_lists").hide(),$(".label_li").each(function(index,item){var $item=$(item),$bar=$item.find(".bar_inner"),width=$bar.attr("data-width");$bar.animate({width:width},300)})}else if(0==data.code){var html="<p class='text-center ' style='padding:50px'>暂无列表数据<p>";$("#index_label_ul").html(html)}}else{var html="<p class='text-center ' style='padding:50px'>"+data.msg+"<p>";$("#index_label_ul").html(html)}}})}};new App})});