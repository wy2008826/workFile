define(function(require,module,exports){require("zepto"),require("fastclick"),FastClick.attach(document.body),$(function(){var App=function(){this.url={wapUrl:$("#wapurl").val(),loginByTelUrl:"/api/loginByPhone.html"},this.match={phone:function(val,required){var telReg=/^1[34578]\d{9}$/;return val.search(telReg)<0?!1:!0}},this.alertMes=function(html){layer.open({content:html,shadeClose:!1,type:1,className:"hasPadding",btn:["好的"]})},this.init(),this.submitForm()};App.prototype={init:function(){function matchTel(){var value=$tel.val(),matched=self.match.phone(value.trim());matched?$next.removeClass("disabled"):$next.addClass("disabled")}var self=this,$next=$("#next"),$tel=$("#tel"),$clearInput=$("#clearInput");$("body").on("click",".layermbtn span",function(){layer.closeAll()}),$tel.focus(function(elem){var $inp=$(this);$inp.closest(".list_item").addClass("active");$clearInput.removeClass("hide")}),$tel.blur(function(elem){var $inp=$(this);$inp.closest(".list_item").removeClass("active");$clearInput.addClass("hide")}),$("#tel")[0].addEventListener("input",function(){matchTel()}),matchTel(),$("#clearInput").on("click",function(){$("#tel").val("").focus()})},submitForm:function(){require("layer");var self=this;$("#next").on("click",function(e){$("#loginForm");if($(this).hasClass("disabled"))return!1;var $phoneInp=$("#tel"),phoneVal=$phoneInp.val();e.preventDefault(),$.ajax({url:self.url.wapUrl+self.url.loginByTelUrl+"?phoneNumber="+phoneVal,type:"get",dataType:"jsonp",success:function(data){if(data.result)if("0"==data.status){var href=self.url.wapUrl+"/passport/reg.html?phoneNumber="+data.phoneNumber;window.location.href=href}else if("-1"==data.status){var href=self.url.wapUrl+"/passport/enterPwd.html?phoneNumber="+data.phoneNumber;window.location.href=href}else{var html="<p class='lh-40'>"+data.msg+"</p>";self.alertMes(html)}else{var html="<p class='lh-40'>"+data.msg+"</p>";self.alertMes(html)}},error:function(){var html="<p class='lh-40'>"+data.msg+"</p>";self.alertMes(html)}})})}};new App})});