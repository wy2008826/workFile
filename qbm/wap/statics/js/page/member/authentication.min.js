define(function(require,exports,module){require("zepto"),require("fastclick"),FastClick.attach(document.body),$(function(){function validateAll(){var realNameVal=$("#realName").val().trim(),IDCard=$("#IDCard").val().trim();if(realNameVal.length>=2&&IDCard.length>=15)return!0}function isIdCardNo(num){var intCheckDigit,factorArr=new Array(7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1),parityBit=new Array("1","0","X","9","8","7","6","5","4","3","2"),varArray=new Array,lngProduct=0,intStrLen=num.length,idNumber=num;if(15!=intStrLen&&18!=intStrLen)return!1;for(i=0;i<intStrLen;i++){if(varArray[i]=idNumber.charAt(i),(varArray[i]<"0"||varArray[i]>"9")&&17!=i)return!1;i<17&&(varArray[i]=varArray[i]*factorArr[i])}if(18==intStrLen){var date8=idNumber.substring(6,14);if(0==isDate8(date8))return!1;for(i=0;i<17;i++)lngProduct+=varArray[i];if(intCheckDigit=parityBit[lngProduct%11],varArray[17]!=intCheckDigit)return!1}else{var date6=idNumber.substring(6,12);if(0==isDate6(date6))return!1}return!0}function isDate6(sDate){if(!/^[0-9]{6}$/.test(sDate))return!1;var year,month;return year=sDate.substring(0,4),month=sDate.substring(4,6),!(year<1700||year>2500)&&!(month<1||month>12)}function isDate8(sDate){if(!/^[0-9]{8}$/.test(sDate))return!1;var year,month,day;year=sDate.substring(0,4),month=sDate.substring(4,6),day=sDate.substring(6,8);var iaMonthDays=[31,28,31,30,31,30,31,31,30,31,30,31];return!(year<1700||year>2500)&&((year%4==0&&year%100!=0||year%400==0)&&(iaMonthDays[1]=29),!(month<1||month>12)&&!(day<1||day>iaMonthDays[month-1]))}var wapurl=$("#wapurl").val();$("input").focus(function(){$(this).closest(".list_item").addClass("active")}),$("input").blur(function(elem){$(this).closest(".list_item").removeClass("active")});var $submit=$("#submit");$("input").on("input",function(){var flag=validateAll();flag?$submit.removeClass("disabled"):$submit.addClass("disabled")}),$submit.on("click",function(){$submit.hasClass("disabled")||require.async("layerCss",function(){require.async("layer",function(layer){var IDCard=$("#IDCard").val().trim(),idCardValidated=isIdCardNo(IDCard);if(idCardValidated){var getRealNameVal=$("#realName").val().trim(),getIDCardVal=$("#IDCard").val().trim();$.ajax({type:"get",url:wapurl+"/api/member/modifyRealName.html",data:{realName:getRealNameVal,cardId:getIDCardVal},dataType:"jsonp",success:function(data){if(data.result)layer.open({content:"恭喜您实名认证成功了，快去理财吧！",className:"layer-tip",shadeClose:!1,time:2,end:function(){window.location.reload()}});else{var html='<div class="fc-31 fs-24 text-center pop-layer"><p>认证失败，原因：'+data.msg+"</p><p>如有问题，请联系客服：400-606-7066</p></div>";layer.open({content:html,type:1,shadeClose:!1,btn:["好的"],yes:function(){layer.closeAll()}})}}})}else layer.open({content:"请输入正确的身份证号码",className:"layer-tip",shadeClose:!1,time:2,end:function(){$("#IDCard").focus()}})})})})})});