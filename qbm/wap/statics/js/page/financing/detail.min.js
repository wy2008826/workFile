define(function(require,exports,module){require("zepto"),require("fastclick"),FastClick.attach(document.body),$(function(){var App=function(){this.url={wapUrl:$("#wapurl").val(),borrowInfo:"/wap/getBorrowInfo.html"},this.getParam=function(key){for(var href=window.location.href,index=href.indexOf("?"),hashArr=href.substr(index+1).split("?")[0].split("&"),i=0;i<hashArr.length;i++){var group=hashArr[i].split("=");if(group[0]==key)return group[1]}},this.borrow_id=this.getParam("borrow_id"),this.init(),this.borrowTime()};App.prototype={init:function(){var self=this,moneyAllInp=$("#money_all"),moneyLeftInp=$("#money_left"),moneyAllVal=moneyAllInp.val().trim(),moneyLeftVal=moneyLeftInp.val().trim(),scale=(moneyAllVal-moneyLeftVal)/moneyAllVal*100;$("#bar_inner").animate({width:scale+"%"},300),$("body").on("click",".tap-link",function(e){if(e.preventDefault(),e.stopPropagation(),$(this).hasClass("bg-default"))return!1;var href=$(this).attr("data-href")+"?borrow_id="+self.borrow_id;window.location.href=href});$("#buy_now")},borrowTime:function(){function setDHMSFormate(endTime,dom,type){var sys_second1=endTime-systemTime,countDown=setInterval(function(){if(sys_second1>1){sys_second1-=1;var day1=Math.floor(sys_second1/3600/24),hour1=Math.floor(sys_second1/3600%24),minute1=Math.floor(sys_second1/60%60),second1=Math.floor(sys_second1%60),showDay1=day1,showHour1=hour1<10?"0"+hour1:hour1,showMinute1=minute1<10?"0"+minute1:minute1,showSecond1=second1<10?"0"+second1:second1;if("text"==type)var htmlStr=showDay1+"天"+showHour1+"小时"+showMinute1+"分"+showSecond1+"秒";else if(":"==type)var showDay1=showDay1?showDay1+"天":"",htmlStr=showDay1+showHour1+":"+showMinute1+":"+showSecond1+"秒后开售，敬请期待";$(dom).html(htmlStr)}else clearInterval(countDown),":"==type&&window.location.reload()},1e3)}var $borrowEndTime=$("#borrowEndTime"),$borrowStartTime=$("#borrowStartTime"),systemTime=$("#sysTime").val(),canBuyEnd=$borrowEndTime.attr("data-time-end"),notStartTime=$borrowStartTime.attr("data-time-end");canBuyEnd?setDHMSFormate(canBuyEnd,$borrowEndTime,"text"):notStartTime&&setDHMSFormate(notStartTime,$borrowStartTime,":")}};new App})});